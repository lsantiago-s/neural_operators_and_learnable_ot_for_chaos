This is the implementation for the paper TBD

@article{tbd,
  title={TBD},
  author={TBD},
  journal={TBD},
  year={2025}
}

## Data Generation

From the repo root, configure the generator in:

- `configs/datagen/datagen_config.json`

Then run:

```bash
python -m pipeline.datagen.generate_data
```

Sampling modes
This generator supports two sampling modes:

1) ```sampling_mode = "independent"``` (default)

Now, each sample is generated by independently solving the IVP once.

Key fields:

- ```n_samples```: number of independent trajectories
- ```t_end```, ```dt```, ```subsample_stride```: define trajectory length after subsampling
Output (```*.npz```) contains:

- ```ids```
- ```traj_<id>```
- ```params_<id>```

2) ```sampling_mode = "crops"```

New behavior: generate one long trajectory, remove a transient prefix, then take random crops.

Key fields (note that these are in timesteps AFTER subsampling):

- ```n_samples```: number of crops to save
- ```crop_length```: crop length in subsampled timesteps
- ```transient_cutoff```: number of subsampled timesteps to discard at the start

Timesteps after subsampling
The ODE solver runs with dt, but we store trajectories after subsampling with:
dt_eff = dt * subsample_stride
Example (from the default config):
dt = 0.01, subsample_stride = 100 ⇒ dt_eff = 1.0
So:
crop_length = 1000 corresponds to ~1000 time units
transient_cutoff = 5000 corresponds to ~5000 time units removed

**Important**: *Timesteps after subsampling*:

The ODE solver runs with ```dt```, but we store trajectories after subsampling with:

```ini
dt_eff = dt * subsample_stride
```

Example:

- ```dt = 0.01```, ```subsample_stride = 100``` ⇒ ```dt_eff = 1.0```

So:

- ```crop_length = 1000``` corresponds to ~1000 time units
- ```transient_cutoff = 5000``` corresponds to ~5000 time units removed

To use crops mode, make ```t_end``` much larger in order to have a long usable trajectory.

### Optimal transport experiment

To train the emulator with the optimal transport (OT) method for chosen data, modify the config files (summary, emulator, train, eval) in ```/configs``` and run:

```bash
bash experiments/new/srun.sh
```

### Evaluation

TBD
